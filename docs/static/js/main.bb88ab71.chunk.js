(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{23:function(t,e,n){t.exports=n(34)},28:function(t,e,n){},33:function(t,e,n){},34:function(t,e,n){"use strict";n.r(e);var a=n(2),o=n.n(a),r=n(19),s=n.n(r),c=(n(28),n(20)),i=n(12),u=n(7),l=n(16),d=n.n(l),h=n(21),p=n(5),f=n(14);n(33);function v(t){return{type:"FeatureCollection",features:t.map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:[t.longitude,t.latitude]}}}))}}var m=function(){var t,e,n,r,s=Object(a.useState)([]),l=Object(p.a)(s,2),m=l[0],b=l[1];Object(a.useEffect)((function(){Object(h.a)(d.a.mark((function t(){var e,n,a,o,r,s,c,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={chargerstations:[]},n=[],t.prev=2,t.next=5,fetch("/data/stations.json");case 5:if((a=t.sent).ok){t.next=8;break}throw a.statusText;case 8:return t.next=10,a.json();case 10:e=t.sent,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.warn(t.t0);case 16:return t.prev=16,t.next=19,fetch("/data/statuses.json");case 19:if((o=t.sent).ok){t.next=22;break}throw o.statusText;case 22:return t.next=24,o.json();case 24:n=t.sent,t.next=30;break;case 27:t.prev=27,t.t1=t.catch(16),console.warn(t.t1);case 30:return t.prev=30,t.next=33,fetch("http://127.0.0.1:8081/stations.json");case 33:if((r=t.sent).ok){t.next=36;break}throw r.statusText;case 36:return t.next=38,r.json();case 38:e=t.sent,t.next=44;break;case 41:t.prev=41,t.t2=t.catch(30),console.warn(t.t2);case 44:return t.prev=44,t.next=47,fetch("http://127.0.0.1:8081/statuses.json");case 47:if((s=t.sent).ok){t.next=50;break}throw s.statusText;case 50:return t.next=52,s.json();case 52:n=t.sent,t.next=58;break;case 55:t.prev=55,t.t3=t.catch(44),console.warn(t.t3);case 58:c=e.chargerstations,i=c.map((function(t){var e,a,o,r=null!==(e=null===(a=t.csmd.Position.match(/([\d]+\.[\d]+),([\d]+\.[\d]+)/))||void 0===a?void 0:a.slice(1))&&void 0!==e?e:["0","0"],s=Object(p.a)(r,2),c=s[0],i=s[1],u=null!==(o=n.find((function(e){return e.uuid===t.csmd.International_id})))&&void 0!==o?o:null;return{longitude:parseFloat(i),latitude:parseFloat(c),status:u}})),b(i);case 61:case"end":return t.stop()}}),t,null,[[2,13],[16,27],[30,41],[44,55]])})))()}),[]);var w=Object(a.useMemo)((function(){return m.filter((function(t){return t.status})).filter((function(t){return-1!==t.status.status}))}),[m]),j=Object(a.useMemo)((function(){return w.reduce((function(t,e){var n,a=e.status.connectors.reduce((function(t,e){return t+(0===e.status?1:0)}),0);a=a>8?8:a;var o=e.status.connectors.length,r="station-"+((o=o>8?8:o)-a)+"-"+a;return t.set(r,[].concat(Object(u.a)(null!==(n=t.get(r))&&void 0!==n?n:[]),[e])),t}),new Map)}),[w]),x=Object(a.useState)({latitude:null!==(t=null===(e=w[0])||void 0===e?void 0:e.latitude)&&void 0!==t?t:60.5,longitude:null!==(n=null===(r=w[0])||void 0===r?void 0:r.longitude)&&void 0!==n?n:8,zoom:5}),g=Object(p.a)(x,2),k=g[0],y=g[1];return void 0===w[0]?o.a.createElement("p",null,"Waiting for data..."):o.a.createElement(f.c,Object.assign({width:"100vw",height:"100vh",mapboxApiAccessToken:"pk.eyJ1Ijoiam9uYXNqc28iLCJhIjoiY2tkbjEzZ2RoMWRwcTJ6bXJwanpnYmFmNyJ9.m7V5GeFoMDSkX8uhyGmYUQ"},k,{onViewportChange:function(t){return function(t){t.width,t.height;var e=Object(i.a)(t,["width","height"]);y(Object(c.a)({},e))}(t)},mapStyle:"mapbox://styles/jonasjso/ckdnf47e32nq31imtzdpo76lw/draft",style:{height:"100vh",width:"100vw"}}),Array.from(j.entries()).map((function(t){var e=Object(p.a)(t,2),n=e[0],a=e[1];return o.a.createElement(f.b,{key:n,id:"source-"+n,type:"geojson",data:v(a)},o.a.createElement(f.a,{type:"symbol",layout:{"icon-image":n,"icon-allow-overlap":!0,"icon-size":["interpolate",["linear"],["zoom"],5,.05,10,.1,15,.2]},paint:{}}))})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(m,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[23,1,2]]]);
//# sourceMappingURL=main.bb88ab71.chunk.js.map